<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>MathBox - Piano</title>
  <script src="./mathbox-bundle.js"></script>
  <link rel="stylesheet" href="./mathbox.css">
  <meta name="viewport" content="initial-scale=1, maximum-scale=1">
</head>
<body>

<script type="application/glsl" id="wavy-shader">
  // Warps coordinates.  Makes the whole keyboard wave.
  uniform float time;         // Additional declaration to import time.
  vec4 getSample(vec4 xyz);
  vec4 getFramesSample(vec4 wxyz) {
    vec4 v= getSample(wxyz);
    float t = v.x + time ;
    // Use 'beat frequencies' between two close frequencies to make a warping
    // in y and z that comes and goes.
    // We are making a very small adjustment on the coordinate, v.
    v = v + 0.003*vec4(
        0.3*cos( 4.4 * t ),
        cos( 4.3 * t )-cos( 4.2 * t ),
        cos( 4.1 * t )-cos( 4.0 * t )+2.5,
        0.0);
    return( v );
  }
</script>

<script type="application/glsl" id="keytilt-shader">
  // Moves selected keys down.
  // We stream data in from two sources....
  vec4 getSampleA(vec4 xyzw);   // External source, key movement.
  vec4 getSample(vec4 xyzw);    // Original source, points of all keys.
  vec4 getFramesSample(vec4 xyzw) {
    vec4  v = getSample(xyzw);
    float a = getSampleA(xyzw).x;
    //This commented out line for 'u' is an alternative that just moves the whole key down.
    //vec4  u = vec4( 0.0, 0.0, a, 0.0 );
    //This value for 'u' moves the front down more than the back.
    //As the angle we are tilting through is small, that's good enough.
    vec4  u = vec4( 0.0, 0.0, a * (v.y +0.2)* 3.5, 0.0 );
    return vec4( v + u);
  }
</script>

<script>
  
var camera = mathbox.camera({
  proxy: true,
  position: [0, 0, 3],
});

</script>

</body>
</html>