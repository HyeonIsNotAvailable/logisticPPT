---
title: 미분방정식을 이용한 현상 모델링
sidebar:
  nav: docs-ko
aside:
  toc: true
key: 20210501
tags: 미분방정식
---

미분방정식은 방정식 안에 미분계수가 포함되어 있는 것을 말한다.

이 때, 미분 계수의 미분 횟수는 1회에서 그치지 않고 여러회 반복될 수 있는데,

가장 간단한 1차 미분방정식(first-order differential equation)의 경우의 형식은 다음과 같다.

$$\frac{dy}{dx}=f(x, y) % 식 (1)$$

우리는 이번 포스팅에서 식 (1)과 같은 미분방정식이 어떻게 나올 수 있었는지를 차근히 알아보고자 한다.

# Exponential Growth

미분은 '변화'에 대한 수학적 서술이다.

상상하기 좋은 변화에 대한 예시 중 하나는 성장인데, 인구 성장에 대한 예시를 통해 미분방정식의 형태를 이끌어내보자.

인구는 기하급수적으로 성장한다. 말이 어려운데, 이것을 풀어서 생각해보면 이렇게도 생각할 수 있다.

인간들은 인구 중 일부가 출산을 하고, 인구 중 일부가 사망함으로써 인구가 성장한다.

그럼 인구의 성장량은 

$$\text{성장 인구 수 }=\text{ 출산 인구 수 } - \text{사망 인구 수} % 식 (2)$$

와 같이 표현할 수 있다.

이 때, 우리는 시간에 대해 생각하고 있지 않았다는 것을 알 수 있다. 중요한 포인트인데, 우리는 성장량을 '단위 시간 동안의 성장'에 대해 생각해야 한다는 점을 간과하면 안된다.

만약 저 식 (2)의 성장량이 100만년 동안의 성장인지, 1년 간의 성장인지 적어 두지 않으면 어떤 의미가 있단 말인가?

그래서 식 (2)를 다음과 같이 수정해 볼 수 있다.

$$\text{특정 시간 동안의 성장 인구 수 }=\text{ 단위 시간 당 출산 인구 수 }\cdot\text{특정 시간} - \text{사망 인구 수}\cdot\text{특정 시간} % 식 (3)$$

식 (3)은 너무 장황하게 한글로 써둔 식이다. 이것을 수학적 표현으로 고쳐써보자.

단위 시간 당 출산인구 수는 현재 인구에 비례할 것이다. 왜냐면, 현재 생존 인구 중 일부만이 출산할 것임을 알 수 있기 때문이다. 단위 시간 당 사망 인구 수도 현재 인구에 비례하는 값임을 쉽게 유추할 수 있다.

시간에 따른 인구수를 $P(t)$라고 하고, 특정 시간 동안 성장한 인구 수를 $\Delta P$라고 하자.

그리고 출산 인구의 비율을 $k_\text{birth}$, 사망 인구의 비율을 $k_\text{death}$라고 하면 아래와 같은 식을 생각할 수 있다.

$$\text{식(3)}\Rightarrow\Delta P \approx k_\text{birth}P(t)\Delta t-k_\text{death}P(t)\Delta t 

% 식 (4)$$

식 (4)를 살짝 고쳐서 $k = k_\text{birth} - k_\text{death}$라고 하면,

$$\Rightarrow \Delta P \approx kP(t)\Delta t % 식 (5)$$

와 같이 쓸 수 있으므로 양변을 $\Delta t$로 나눠주면 아래와 같은 식을 얻게 됨을 알 수 있다.

$$\frac{\Delta P}{\Delta t}\approx k P(t) % 식 (6)$$

식 (6)의 의미는 단위 시간 당 인구수의 변화는 현재 인구수에 비례한다는 뜻이다.

식 (6)에 대해 $\Delta t$를 매우 작게 만들어주면 미분방정식을 얻을 수 있게 된다.

$$\Rightarrow \lim_{\Delta t \rightarrow 0}\frac{\Delta P}{\Delta t}=\frac{dP}{dt}% 식 (7)$$

이므로,

$$\therefore \frac{dP}{dt}=kP % 식 (8)$$

위 식은 식 (1)에서 보여준 미분 방정식의 형태와 같다는 것을 알 수 있다.

식 (8)의 미분방정식의 솔루션은 

$$P(t) = Ce^{kt} % 식 (9)$$

임을 알 수 있다.

식 (9)를 식 (8)에 다시 대입해보면

$$Cke^{kt} = kCe^{kt} % 식 (10)$$

가 성립한다는 것을 알 수 있기 때문이다.

여기서 만약 우리가 첫 시작 인구수를 알 수 있다면  식 (9)의 $C$ 값을 특정할 수도 있을 것이다.

가령, $t=0$일 때의 인구수가 $P_0$라고 한다면,

$$식(9)\Rightarrow P(t) = P_0e^{kt} % 식 (11)$$

임을 알 수 있는것이다.

# Logistic growth

인구수는 기하급수적으로 성장한다는 말은 많이 들어봤을지 모르지만, 인구수의 성장에는 사실 한계가 있다.

최근 대한민국은 출산율 저하로 고민하고 있는데, 이런 추세의 성장률이라면 인구수 하락은 면치 못할 미래가 될 것이라는 것이 불보듯 뻔하다.

인구수는 왜 계속해서 커지지 못할까?

자원의 한계가 있기 때문이다.

페트리 디쉬에 있는 박테리아는 아무리 그 숫자가 많아지더라도 페트리 디쉬의 크기 이상을 벗어나기 힘든 것과 마찬가지이다.

<p align = "center">
  <img width = "500" src ="https://raw.githubusercontent.com/angeloyeo/angeloyeo.github.io/master/pics/2021-05-01-modeling_with_differential_equation/pic1.png">
  <br>
  그림 1. 페트리 디쉬 안에 있는 박테리아는 개체수에 한계가 있어 logistic growth 형태를 따라 성장해간다.
  
</p>


식 (8)을 조금 수정해서 성장할 수 있는 최대치에 가까워질 수록 성장량이 더뎌지는 모델을 만들어보자.

식 (8)에 다음과 같은 조치를 취해보자.

$$식 (8) \Rightarrow \frac{dP}{dt}=kP(1-\frac{P}{N}) % 식 (12)$$

즉, 식 (8)에서 $(1-P/N)$이라는 함수를 덧붙였다.

여기서 $N$은 최대 성장치로, 식 (12)가 말해주는 것은 인구수의 변화량은 $P$가 $N$에 다다를 수록 0에 가까워진다는 뜻으로 해석할 수 있다. 왜냐면 $(1-P/N)$은 $P=0$ 일 때는 $(1-P/N)=1$이지만 $P$가 $N$에 다다를 수록 $(1-P/N)=0$에 가까워질 것이기 때문이다.

이와 같은 모델의 솔루션은

$$P=\frac{N}{Ce^{-kt}+1} % 식 (13)$$

라고 알려져 있다. (식 (13)이 식 (12)에 대한 solution임은 직접 확인해보도록 하자.)

$N, C, k$에 적절한 값을 넣었을 때 그래프의 형태는 아래와 같다.

아래의 그래프에서는 $N=1000$이라는 값을 넣었는데, 이것이 말하는 것은 최대 수용 인구수가 1000이라는 뜻이다. 그래서 시간이 지날 수록 인구수는 1000에 수렴한 뒤 변화가 없는 것을 알 수 있다.

<p align = "center">
  <img src ="https://raw.githubusercontent.com/angeloyeo/angeloyeo.github.io/master/pics/2021-05-01-modeling_with_differential_equation/pic2.png">
  <br>
  그림 2. logistic growth의 예시 그래프 중 하나
</p>

# 스프링의 움직임에 관한 현상

후크의 법칙이라고 알려진 스프링의 움직임에 관한 식은 다음과 같다.

$$F = -kx % 식 (14)$$

여기서 음수가 붙은 것은 스프링이 늘어난 방향과 이 때 작용하는 힘의 방향이 반대라는 의미이다.

이러한 관계식은 다음과 같은 현상을 관찰하여 알게된 사실을 기반으로 한다.

<p align = "center">
  <img src ="https://raw.githubusercontent.com/angeloyeo/angeloyeo.github.io/master/pics/2021-05-01-modeling_with_differential_equation/pic3.png">
  <br>
  그림 3. 후크의 법칙 유도 과정
  <br>
  <a href ="https://ko.wikipedia.org/wiki/%ED%9B%85_%EB%B2%95%EC%B9%99"> 그림 출처: 훅 법칙 위키피디아</a>
</p>

그림 3에서 보여주듯이 용수철은 늘여준 길이에 비례해 탄성력이 작용한다는 것을 실험적으로 알게되어서 그 현상을 식 (14)와 같이 설명한 것이다.

그럼 식 (14)는 미분방정식이라고 할 수 있는 것일까? 힘은 질량 x 가속도로 풀어쓸 수 있기 때문에 식 (14)는 다음과 같이도 쓸 수 있다.

$$m\frac{d^2x}{dt^2}=-kx % 식 (15)$$

즉, 식 (15)를 보면 후크의 법칙은 2계 미분방정식이었다는 것을 알 수 있다.

이 미분방정식에 대한 solution은 다음과 같다.

$$x(t) = A\cos(t) + B \sin(t) % 식 (16) $$

만약 $m=1$이고 $k=1$이라고 하고, $x(0) = 0$, $x'(0) = 1$이라는 조건을 부여했을 때 식(16)은

$$x(t) = sin(t) % 식 (17)$$

라는 것을 알 수 있다.