---
title: 최대우도법(MLE)
sidebar:
  nav: docs-ko
aside:
  toc: true
key: 20200717
tags: 통계학
---
{% raw %}

  <p align = "center">
    <iframe width ="800" height = "500" src="https://angeloyeo.github.io/p5/2020-07-17-MLE_preview/" frameborder = "0"></iframe>
     <br>
     어떤 평균값을 갖는 확률밀도로 부터 이 샘플들이 추출되었을까?
     <br>
     adapted from the Seeing Theory's amazing visualization of MLE
  </p>


# 최대우도법의 정의

최대우도법(Maximum Likelihood Estimation, 이하 MLE)은 모수적인 데이터 밀도 추정 방법으로써 파라미터 $\theta = (\theta_1, \cdots, \theta_m)$으로 구성된 어떤 확률밀도함수 $P(x\|\theta)$에서 관측된 표본 데이터 집합을 $x = (x_1, x_2, \cdots, x_n)$이라 할 때, 이 표본들에서 파라미터 $\theta = (\theta_1, \cdots, \theta_m)$를 추정하는 방법이다.

당연히, 이 말만 보면 MLE가 뭔지 이해하기는 불가능하기 때문에 예시를 들어 MLE에 대해 알아보도록 하자.

## MLE의 예시

MLE의 핵심 아이디어를 이해하기 위해 아래와 같은 매우 간단한 toy example을 생각해보자.

다음과 같이 5개의 데이터를 얻었다고 가정하자.

$$x = \lbrace1,4,5,6,9\rbrace$$

이 때, 아래의 그림을 봤을 때 데이터 $x$는 주황색 곡선과 파란색 곡선 중 어떤 곡선으로부터 추출되었을 확률이 더 높을까?

<p align = "center">
  <img width = "800" src = "https://raw.githubusercontent.com/angeloyeo/angeloyeo.github.io/master/pics/2020-07-17-MLE/pic1.png">
  <br>
  그림 1. 획득한 데이터와 추정되는 후보 분포 2개(각각 주황색, 파란색 곡선으로 표시)
</p>

눈으로 보기에도 파란색 곡선 보다는 주황색 곡선에서 이 데이터들을 얻었을 가능성이 더 커보인다.

왜냐면 획득한 데이터들의 분포가 주황색 곡선의 중심에 더 일치하는 것 처럼 보이기 때문이다.

이 예시를 보면, 우리가 데이터를 관찰함으로써 이 데이터가 추출되었을 것으로 생각되는 분포의 특성을 추정할 수 있음을 알 수 있다. 여기서는 추출된 분포가 정규분포라고 가정했고, 우리는 분포의 특성 중 평균을 추정하려고 했다.

그럼 좀 더 구체적으로, 수학적인 방법으로 정밀하게 이 분포의 특성을 추정하는 방법을 이해해보도록 하자.

# Likelihood function

앞서 언급한 수학적인 추정방법을 MLE라고 할 수 있는데, 이를 위해선 각 데이터의 likelihood 기여도를 계산해야 한다.

<p align = "center">
  <img width = "800" src = "https://raw.githubusercontent.com/angeloyeo/angeloyeo.github.io/master/pics/2020-07-17-MLE/pic2.png">
  <br>
  그림 2. 주황색 후보 분포에 대해 각 데이터들의 likelihood 기여도를 점선의 높이로 나타냈다.
</p>

likelihood 라는 것은 특별히 어려운 것이 아니고, 지금 얻은 데이터가 이 분포로부터 나왔을 가능도를 말한다.

수치적으로 이 가능도를 비교해볼 수 있는 방법은 생각해볼 수 있는 후보 분포들에 대해서 각 데이터 샘플에서 후보 분포들에 대한 높이(즉, 확률밀도함수의 높이 혹은 확률질량함수의 높이)를 계산해서 다 곱해주는 것이 합리적인 방법이 될 수 있다.

계산된 높이를 더해주지 않고 곱해주는 것은 모든 데이터들의 추출이 연달아 일어나는 사건이기 때문이다.

///////////// 여기부터 내용 추가 할 것 ///////////////////

아래와 같이 전체 표본집합의 결합확률밀도 함수를 likelihood function이라고 한다.

$$P(x|\theta) = \prod_{k=1}^{n}P(x_k|\theta)$$

위 식의 결과 값이 가장 커지는 $\theta$를 추정값 $\hat{\theta}$로 보는 것이 가장 그럴듯하다.

위 식을 likelihood function이라고 하고 보통은 자연로그를 이용해 아래와 같이 log-likelihood function $L(\theta \| x)$를 이용한다.

$$L(\theta| x) = log P(x|\theta) = \sum_{i=1}^{n}log P(x_i | \theta)$$

# 참고 문헌

1. 패턴인식 개론 / 한빛아카데미 / 한학용
2. Lecture 13 (Greene Ch 16) Maximum Likelihood Estimation (MLE) / Lynette Bryan / https://slideplayer.com/slide/5290248/


{% endraw %}
