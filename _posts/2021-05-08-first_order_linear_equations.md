---
title: 1차 선형 미분 방정식의 해법
sidebar:
  nav: docs-ko
aside:
  toc: true
key: 20210508
tags: 미분방정식
---

지난 [변수분리법](https://angeloyeo.github.io/2021/05/06/separable_differential_equations.html) 포스팅에서는 가장 단순한 1차 선형 미분방정식의 형태인 변수분리형 미분방정식에 대해 풀어보았다.

이번 시간에는 변수분리법으로는 풀 수 없는 조금 더 일반적인 형태의 1차 선형 미분 방정식의 해법에 대해 알아보고자 한다.

우리가 풀고자하는 미분방정식의 형태는 다음과 같다.

$$\frac{dx}{dt}+p(t)x=q(t) % 식 (1)$$

위의 식 (1)이 변수분리법에서 본 식과 다른 점은 가운데 있는 $p(t)$가 더 이상 상수가 아니라는 점이다.

만약 $p(t)$가 $t$에 관한 식이 아니라면 변수분리법으로 문제를 해결할 수 있을 것이다.

# 1차 선형 미분 방정식의 해법

식 (1)과 같은 형태의 미분 방정식을 풀기 위해선 미분의 연쇄법칙(chain rule)을 이용해야 한다.

식 (1)의 가운데에 있는 $p(t)$에 대해서, $P'(t) = p(t)$ 혹은 $\int p(t) dt = P(t)$와 같은 관계를 갖는 $P(t)$를 생각해보자.

그러면 $e^{P(t)}x$의 $t$에 대한 미분은 다음과 같이 쓸 수 있다는 것을 알 수 있다.

$$\frac{d}{dt}\left(e^{P(t)}x(t)\right)=e^{P(t)}P'(t)x(t) + e^{P(t)}x'(t) % 식 (2)$$

$$=e^{P(t)}\left\lbrace P'(t)x(t)+x'(t)\right\rbrace % 식(3)$$

$$=e^{P(t)}\left\lbrace p(t)x(t) + x'(t)\right\rbrace % 식(4)$$

식 (4)의 중괄호 안에 있는 식은 결국 식 (1)의 좌변과 같은 것이다. 따라서,

$$식(2)\Rightarrow \frac{d}{dt}\left(e^{P(t)}x(t)\right) = e^{P(t)}q(t)$$

$$\therefore e^{P(t)x}=\int e^{P(t)q(t)}dt + C$$

즉,

$$x(t) = \frac{1}{e^{P(t)}}\left(\int e^{P(t)}q(t)dt + C\right)$$

와 같이 풀어지는 것을 알 수 있다.

여기서 중요한 포인트 중 하나는 $x$에 $e^{P(t)}$를 곱해주는 과정에서 이 해법이 시작된다는 점인데, $e^{P(t)}$를 적분 인자(integrating factor)라고 한다.

# 예시 문제

미분방정식은 이 해법이 어떻게 작동하는지 알아보는 것이 중요하기 때문에 실제로 문제를 많이 풀어보는 것이 중요할 것이다.

## 소금물 채워넣기 문제

이전 [변수분리법](https://angeloyeo.github.io/2021/05/06/separable_differential_equations.html) 포스팅에서 본 문제를 살짝 업그레이드 해서 소금물 채워넣기 문제를 풀어보자.

이전 변수분리법 포스팅에서와는 달리 이번에는 물의 수위가 계속 올라갈 수 있게 문제를 수정할 것이다.

물탱크에 소금물을 집어넣어서 물탱크에 들어있는 물의 염도가 상승할 수 있게 만든다고 하자.

가령, 물탱크의 총 부피는 1000 리터인데, 500 리터의 맹물이 들어있고, 0.5kg/L 농도의 소금물을 계속해서 넣어주기 시작한다고 하자.

이 때, 1분에 10L의 0.5kg/L 농도의 소금물이 계속해서 들어가게 된다고 하자.

물탱크의 소금물은 균일하게 섞일 수 있도록 물탱크의 물을 계속 저어주고 있다고 가정하겠다.

그런데, 물탱크의 바닥에 물이 새고 있다고 하자. 물이 새는 속도는 1분당 9L라고 해보겠다.

이런 경우 시간에 따른 소금물의 농도는 어떻게 변하게 될까?

---

이 문제는 미분방정식을 이용해야 하는 문제이고, 1차 선형미분방정식을 이용해야 한다.

물탱크 안의 소금의 양을 $x(t)$라고 해보자. 그러면, 물탱크 안의 소금양의 시간에 따른 변화율은 $dx/dt$ 일 것이다.

또, 소금의 시간 당 변화율은 들어오는 소금의 비율과 나가는 소금의 비율의 차이이므로,

$$\frac{dx}{dt}=\text{rate in } - \text{rate out} % 식 (8)$$

이라고 쓸 수 있다.

들어오는 소금물은 10L인데, 그중 5kg이 소금이므로 1분당 5kg의 소금이 들어오는 셈이다. 즉,

$$\text{rate in}=5$$

이다.

한편, 물탱크 안에 들어있는 소금물의 부피 $V(t)$는 처음에는 500 리터였다가 10L의 물이 들어오고 9L의 물이 나가므로 매 1분마다 1L씩 늘어난다. 따라서 $V(t) = 500 + t$이라고 할 수 있다.

따라서, 나가는 소금의 양은 현재 물탱크 안의 소금 양 $x$에 비례하고 현재 물탱크 안의 물 부피 $V(t)$에 반비례 할 것이다. 즉,

$$\text{rate out}=\frac{9}{500+t}x$$

이다.

따라서, 

$$\frac{dx}{dt}=5-\frac{9}{500+t}x % 식 (11)$$

와 같이 미분방정식을 세워줄 수 있다.

위 식을 다시 살짝 정리하면,

$$\Rightarrow \frac{dx}{dt}+\frac{9}{500+t}x=5 % 식 (12)$$

과 같은데, 양변에 곱할 적분 인자 $\mu(t)$를 계산해보면 다음과 같다.

$$\mu(t)=\exp\left(\int \frac{9}{500+t}dt\right)=e^{9\ln(500+t)}=(500+t)^9$$

따라서, 식 (12)의 양변에 적분인자 $\mu(t)$를 곱해주면,

$$\Rightarrow (500+t)^9\frac{dx}{dt}+9(500+t)^8x=5(500+t)^9$$

$$\Rightarrow \frac{d}{dt}\left[(500+t)^9x\right]=5(500+t)^9$$

양변을 적분해주면,

$$(500+t)^9x=\frac{5}{10}(500+t)^{10}+C$$

$$\therefore x(t) = \frac{1}{2}(500+t)+\frac{C}{(500+t)^9}$$

이다.

처음에 물탱크에 들어있는 물은 소금이 하나도 들어있지 않은 맹물이었으므로,

$$x(0) = \frac{1}{2}(500+0)+\frac{C}{(500+0)^9}=250+\frac{C}{500^9}=0$$

따라서,

$$C = -250 * 500^9=-\frac{1}{2}\times 500^{10}$$

임을 알 수 있다.

물탱크의 물은 500분 후에 가득채워질텐데 이 때 까지의 소금양에 관한 그래프를 그려보면 다음과 같을 것이다.

<p align = "center">
  <img width = "600" src = "https://raw.githubusercontent.com/angeloyeo/angeloyeo.github.io/master/pics/2021-05-08-first_order_linear_equations/pic1.png">
  <br>
  그림 1. 물이 새는 물탱크에 소금물을 서서히 채워넣어 줄 때 물탱크 내의 소금양의 변화
</p>
