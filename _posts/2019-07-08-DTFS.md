---
title: 이산시간 푸리에 급수(Discrete Time Fourier Series)
sidebar:
  nav: docs-ko
aside:
  toc: true
key: 20190708
tags: 푸리에 신호처리
---

DTFS의 유도 과정은 CTFS의 유도 과정과 거의 흡사하다고 할 수 있다. 삼각함수의 orthogonality를 이용해서 주기 함수를 decompose한다는 개념이 동일하게 이용된다.

# Prerequisites

이 포스팅을 잘 이해하기 위해선 아래의 내용에 대해 알고 오시는 것이 좋습니다.

* [연속 신호의 샘플링](https://angeloyeo.github.io/2022/01/14/sampling_CT_to_DT.html)
* [푸리에 급수](https://angeloyeo.github.io/2019/06/23/Fourier_Series.html)

# 이산 정현파 신호의 주파수 특성

이산 신호는 연속 신호를 시간 샘플링해 얻은 것이다. 얼핏 생각하면 샘플링 주기를 매우 짧게 만들어주면 연속신호처럼 보이기 때문에 연속신호와 별다른 차이없이 분석을 수행할 수 있을 것이라고 생각할 수 있다.

그러나, 샘플링을 통해 얻게되는 부수적인 효과로 이산 정현파만의 특이한 주파수 특성을 보이게 된다.

이산시간 푸리에 급수에서도 [연속 시간 푸리에 급수](https://angeloyeo.github.io/2019/06/23/Fourier_Series.html)에서와 마찬가지로 복소 정현파를 이용해 주기 신호를 분석한다.

따라서, 우리는 샘플링된 복소 정현파에 대해 생각해보자.

가령 주기가 6인 복소 정현파는 다음과 같이 표현할 수 있다.

$$\exp\left(j\frac{2\pi n}{6}\right)\text{ where } n\in \mathbb{N}$$

여기서 $n$이 0일 때부터 값을 넣어가며 복소 평면에 좌표를 찍어보면 다음과 같은 결과를 확인할 수 있다.

<p align = "center">
  <img width = "500" src = "https://raw.githubusercontent.com/angeloyeo/angeloyeo.github.io/master/pics/2019-07-08-DTFS/pic1.png">
  <br>
  그림 1. 주기가 6인 복소 정현파
</p>

즉 주기가 6인 복소 정현파의 값은 복소 평면 위의 단위원을 6등분한 호 위의 점들 6개의 값과 대응된다.

그리고 단위원 위의 6개 점들은 원의 특성상 $2\pi$의 주기성을 띈다.

<p align = "center">
  <img width = "500" src = "https://raw.githubusercontent.com/angeloyeo/angeloyeo.github.io/master/pics/2019-07-08-DTFS/pic2.png">
  <br>
  그림 2. 
</p>



# 이산 시간 도메인에서 함수의 직교성

 DTFS를 유도하기 전에 discrete time에서의 orthogonality의 정의와, DTFS에 이용될 함수의 집합의 orthogonality에 대한 증명이 필요하다. 그러므로, DTFS의 유도과정에 필요한 정의와 증명을 먼저 적고, DTFS에 대한 유도과정을 증명하도록 하겠다.

주기 N에 대하여 두 이산 신호 $\phi_k[n]$ 와 $\phi_p [n]$ 는 다음이 성립할 때 직교한다고 할 수 있다. 

$$\sum_{n=0}^{N-1}{\phi_k[n]\phi^*_p[n] =0 \space when \space k\neq p }$$

여기서 $\phi^*_p[n]$ 에서 '\*' 는 켤레복소수 연산임

$$
\left\{
     \phi_k[n] | \phi_k[n] = exp\left(j \frac{2\pi k}{N}n\right)\space where \space k = 0, 1,2,\cdots, N-1
\right\}
$$

Proof)

식 (2)와 같은 집합에 대하여,

이산 시간 영역에서의 직교성의 정의에 의하여

$$\sum_{n=0}^{N-1}{\phi_k[n]\phi^*_p[n]}$$

$$=\sum_{n=0}^{N-1} exp\left(j \frac{2\pi k}{N}n\right)exp\left(-j \frac{2\pi p}{N}n\right)$$

$$=\sum_{n=0}^{N-1} exp\left(j \frac{2\pi (k-p)}{N}n\right)$$

$$=\sum_{n=0}^{N-1} \left\{ exp\left(j\frac{2\pi(k-p)}{N}\right)^n\right\}$$

참고로 식 (5)에서 식 (6)으로 넘어갈 때에는 지수 법칙 중 다음이 이용된 것이다.

$$x^{mn} = \left(x^m\right)^n$$

이제 정수 $k$, $p$ 에 대하여 두 가지 경우가 있을 수 있다.

1) $k=p$ 인 경우

식 (5)는 다음과 같이 쓸 수 있다.

$$식(5) \Rightarrow\sum_{n=0}^{N-1}{exp\left(j\frac{2\pi n}{N}(0)\right)} = N$$

2) $k\neq p$ 인 경우

식 (6)은 자세히 보면 초항이 1이고 공비가 $exp(j \frac{2\pi (k-p)}{N})$ 인 등비급수의 합을 나타내는 것으로 볼 수 있다.

일반적으로 초항이 $a$ 이고 공비가 $r$ 인 등비급수의 합은 다음과 같다.

$$ S_n = a\left(\frac{1-r^n}{1-r}\right)$$

따라서, 등비급수 합의 공식을 이용하여 식 (5)는 다음과 같이 바꿔 쓸 수 있다.

$$\Rightarrow
\frac
{1-exp\left(j \frac{2\pi(k-p)}{N}\right)^N}
{1-exp\left(j \frac{2\pi(k-p)}{N}\right)}
$$

식 (7)의 지수법칙을 이용하면,

$$=\frac
{1-exp\left(j2\pi(k-p)\right)}
{1-exp\left(j\frac{2\pi(k-p)}{N}\right)}
$$

정수 n에 대하여, $exp(j2\pi n) = 1$ 이므로

$$ = 0$$

따라서, $\{\phi_k[n]\}$ 은 직교 집합(orthogonal set)임을 알 수 있다.

Q.E.D.

# 이산 푸리에 급수 공식 유도

DTFS의 공식은 식 (2)의 함수 집합의 직교성(orthogonality)의 성질을 이용하여 얻을 수 있다.

주기가 $N$ 인 이산신호 $x[n]$ 에 대하여,

$$ x[n] = x[n+N] $$

$$ x[n] = \sum_{k=0}^{N-1}{a_k \space exp\left(j \frac{2\pi k}{N}n\right)} $$

where

$$a_k =\frac{1}{N}\sum_{n=0}^{N-1}x[n] exp\left(-j \frac{2\pi k}{N}n\right) \space for \space k = 0, 1, \cdots, N-1$$


여기서 DTFS에서의 상수항인 $a_k$의 유도과정은 다음과 같다.

이산 시간 도메인에서의 직교성의 성질을 이용하기 위해 $x[n]$ 에 $\phi^*_r[n]$ 을 곱하여 summation을 취해보자.

$$\sum_{n=0}^{N-1}x[n]\phi^*_r[n]$$

식 (14)의 DTFS의 정의에 의해,

$$=\sum_{n=0}^{N-1}
\left(\sum_{k=0}^{N-1}{a_k \space exp\left(j \frac{2\pi k}{N}n\right)}\right)
\phi^*_r[n]$$

여기서 $exp\left(j \frac{2\pi k}{N}n\right)$ 을 $\phi_k[n]$ 으로 대체해 생각하면,

$$=\sum_{n=0}^{N-1}
\left(\sum_{k=0}^{N-1}{a_k \space \phi_k[n]}\right)
\phi^*_r[n]$$

$$= \sum_{n=0}^{N-1}a_k\sum_{k=0}^{N-1}\phi_k[n]\phi^*_r[n]$$

$$=\sum_{n=0}^{N-1}a_kN\delta[k-r]$$

$$= N a_k$$


따라서, DTFS의 계수는 다음과 같다.

$$a_k =\frac{1}{N}\sum_{n=0}^{N-1}x[n] exp\left(-j \frac{2\pi k}{N}n\right) \space for \space k = 0, 1, \cdots, N-1$$

